# Scenario
During routine monitoring at MalaCrypt company, a suspicious binary named "malware.exe" was found on a device. Initial checks of its hash values against threat intelligence platforms yielded no results, suggesting the attacker may have altered the malware to evade detection. As a security analyst, the next action is to investigate further, using alternative methods beyond hash-based detection, considering that attackers often modify hashes to bypass initial security checks.

# Introduction
This lab is focused on conducting static and dynamic analysis of a malware sample using malware analysis tools such as Pestudio, procmon, Floss, CAPA and Cutter

## Question 1 Understanding the type of binary architecture allows us to determine the types of registers being used. What architecture is this binary built for?
As the question states knowing the underlying architecture of a malware sample is crucial in identifying the approrpriate registers and understanding how the assembly code of the binary may look to assist in reverse engineering.

Pestudio is a tool used to analyse portable executable files and can provide insights into the file metadata, the presence of packing/obfuscation, the imported functions of a program, suspicious strings and can even provide insights into what the suspicious strings could be doing. It is a safe start to analyse any malware file.

We can find the architecture within the **file header** section in the **Machine** property.

![image](https://github.com/user-attachments/assets/813f5bc5-a0d9-4b60-bc19-a51c578dc2f7)

Answer: x64

## Question 2 Executables are sometimes renamed or altered to evade detection or disguise their true purpose. What is the original name of the executable?
When a portable executable is first compiled it will save its original filename within its structure, if the filename is then changed by the attacker it can still be found using pestudio

Go to the Root of the hierarchy

find **version > Original filename**

Answer: DefaultViewer.exe

## Question 3 Some DLL files are responsible for accessing Windows registries. Which DLL file is utilized to manipulate the Windows Registry?

Finding out which DLLs are loaded can be acheived by looking in the **libraries** section. This provides a list of all used libraries in the file

Understanding what the libraries are being used for can be acheived by looking in the **imports** section where all API's used by any of the libraries are listed. Pestudio automatically flags known malicious API calls and provides ATT&CK matrix techniques for any malicious API calls, we can see that it has flagged a certain import (RegSetValueExA) for possible Registry Modification. We can then look at the library it belongs to to determine the malicious library.
![image](https://github.com/user-attachments/assets/5042de5c-dfeb-442d-a684-534fe330c039)

It should be noted that information on the libraries and the imports is not a known threat but can still be utilised to perform attacks. It is wise to conduct external research on the libraries to understand the scope of the program and the imports to determine what it intended to do.
Answer: ADVAPI32.dll

## Question 4 Certain strings may reveal specific information. What is the name of the Chinese messaging app discovered in the basic static analysis?
We can use the floss tool to extract human readable strings from the binary, it is also capable of extracting obfuscated strings.

FLOSS extracts and reveals:

Static strings: Plaintext strings embedded directly in the binary.

Stack strings: Strings dynamically constructed at runtime by the program (e.g., built on the stack from individual characters or bytes).

Decoded strings: Strings that were obfuscated or encoded in the binary but FLOSS successfully decodes using known methods (XOR, Base64, etc.).

Contextual info: Which functions the strings appear in, helping link strings to specific code behavior.

Metadata & diagnostics: Info about the file and analysis process, plus warnings if something couldnâ€™t be processed.

When we run this against our application we can see that some strings created at runtime include the chinese chat platform, this was likely to be hidden from basic static analysis techniques.

![image](https://github.com/user-attachments/assets/1f92fe18-35f9-4cbb-b9a2-e04114f64cbb)

Answer: wechat

## Question 5 The Windows API can be used for malicious purposes. Which Windows API is used to destroy previously generated encryption keys? 

