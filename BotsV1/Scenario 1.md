# Scenario
The focus of this hands on lab will be an APT scenario and a ransomware scenario. You assume the persona of Alice Bluebird, the soc analyst who has recently been hired to protect and defend Wayne Enterprises against various forms of cyberattack.

Today is Alice's first day at the Wayne Enterprises' Security Operations Center. Lucius sits Alice down and gives her first assignment: A memo from Gotham City Police Department (GCPD). Apparently GCPD has found evidence online (http://pastebin.com/Gw6dWjS9) that the website www.imreallynotbatman.com hosted on Wayne Enterprises' IP address space has been compromised. The group has multiple objectives... but a key aspect of their modus operandi is to deface websites in order to embarrass their victim. Lucius has asked Alice to determine if www.imreallynotbatman.com. (the personal blog of Wayne Corporations CEO) was really compromised.

In this scenario, reports of the below graphic come in from your user community when they visit the Wayne Enterprises website, and some of the reports reference "P01s0n1vy." In case you are unaware, P01s0n1vy is an APT group that has targeted Wayne Enterprises. Your goal, as Alice, is to investigate the defacement, with an eye towards reconstructing the attack via the Lockheed Martin Kill Chain.

## Question 1: Web Defacement: What content management system is imreallynotbatman.com likely using? (Please do not include punctuation such as . , ! ? in your answer. We are looking for alpha characters only.)
Finding out what CMS is available for "imreallynotbatman.com" is as simple as looking at the http logs and searching for the phrase, we can pass the results to a table and display the uri and request for all matches, which
may include the CMS directories

Screenshot: <img width="1915" height="880" alt="image" src="https://github.com/user-attachments/assets/af4c2a76-30ae-475c-8738-8688c59c7251" />

Answer: joomla

## Question 2: Web Defacement: What is the likely IP address of someone from the Po1s0n1vy group scanning imreallynotbatman.com for web application vulnerabilities?

We know that when an attacker scans a website for vulnerabilities they will typically use automated tools, these tools while proficient in identifying known vulnerabilities make alot of noise with the number of requests sent
to the server from one single IP. Sometimes the user-agent or other headers can identify the scanner being used, but to simply identify a flood of traffic from a single ip we can filter through the logs and count the occurences
of all src_ips and identify anomalies such as external ips and large number of requests.

When identifying traffic of interest we can look in the suricata IDS logs which stores any of the traffic captured on the IDS interface, suricata logs all http requests it sees, we can use the metdata generated by suricata 
for all http events to filter for our victim domain and count the number of occurences of a source IP in the HTTP traffic. The one with the highest records is likely the attacker ip.

Query:`index=botsv1 sourcetype=suricata http.hostname="imreallynotbatman.com" | table src_ip| stats count by src_ip | sort -count reverse`
Screenshot: <img width="1914" height="924" alt="image" src="https://github.com/user-attachments/assets/c6a92804-f6ce-43fb-84fd-549aff0a43b7" />

Now we have the IP we can drill into the data and try to present finding of vulnerability scanning

Common indicators of vulnerability scanning include:
- Different source ports connecting to one server
- Different user-agents from the one computer
